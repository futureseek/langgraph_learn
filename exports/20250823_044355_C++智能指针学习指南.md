# C++智能指针学习指南

## 文档信息

- **内容长度**: 807 字符
- **内容类型**: AI 生成内容

## 生成信息

- **生成时间**: 2025-08-23 04:43:55
- **生成工具**: LangGraph 聊天机器人

## 内容

## C++智能指针简介

在C++程序设计中，动态内存管理是一个重要但容易出错的部分。传统的使用`new`和`delete`的方式容易导致内存泄漏、悬空指针等问题。为了解决这些问题，C++11引入了智能指针（Smart Pointer）。

智能指针利用RAII（资源获取即初始化）技术，将原始指针封装为一个栈对象。当栈对象生命周期结束时，在析构函数中自动释放内存，从而防止内存泄漏。

### 主要类型

1. **shared_ptr**
   - 多个shared_ptr可以指向同一个对象
   - 使用引用计数机制管理资源
   - 当最后一个shared_ptr被销毁时，才会释放资源

2. **unique_ptr**
   - 独占所指向的对象
   - 不允许拷贝，但可以通过移动转移所有权
   - 资源管理更高效，推荐优先使用

3. **weak_ptr**
   - 配合shared_ptr使用
   - 不增加引用计数
   - 用于解决循环引用问题

### 基本使用

```cpp
#include <memory>

// 创建unique_ptr
std::unique_ptr<int> ptr1 = std::make_unique<int>(10);

// 创建shared_ptr
std::shared_ptr<int> ptr2 = std::make_shared<int>(20);

// weak_ptr通常从shared_ptr创建
std::weak_ptr<int> ptr3 = ptr2;
```

### 注意事项

- C++98中的auto_ptr已被废弃，不推荐使用
- 优先使用unique_ptr，仅在需要共享所有权时使用shared_ptr
- 避免混合使用原始指针和智能指针
- 注意循环引用问题，适当使用weak_ptr